---
title: AI-SDK
description: "Send Vercel AI-SDK OpenTelemetry spans to Keywords AI."
---

## Overview

Use `@keywordsai/exporter-aisdk` to export [Vercel AI SDK](https://ai-sdk.dev/) traces (OpenTelemetry spans) to Keywords AI.

## Quickstart

### Step 1: Get a Keywords AI API key

Create an API key in the [Keywords AI dashboard](https://platform.keywordsai.co/platform/api/api-keys).

<Frame className="rounded-md">
<img src="https://keywordsai-static.s3.us-east-1.amazonaws.com/docs/documentation/admin/kai_create_api_key_v0.png" alt="Create a Keywords AI API key" />
</Frame>

### Step 2: Install packages

Install the exporter and the AI-SDK dependencies:

<CodeGroup>
```bash npm
npm i @keywordsai/exporter-aisdk ai @ai-sdk/openai @opentelemetry/api @opentelemetry/sdk-trace-base @opentelemetry/context-async-hooks dotenv
```

```bash yarn
yarn add @keywordsai/exporter-aisdk ai @ai-sdk/openai @opentelemetry/api @opentelemetry/sdk-trace-base @opentelemetry/context-async-hooks dotenv
```

```bash pnpm
pnpm add @keywordsai/exporter-aisdk ai @ai-sdk/openai @opentelemetry/api @opentelemetry/sdk-trace-base @opentelemetry/context-async-hooks dotenv
```
</CodeGroup>

### Step 3: Set environment variables

Create a `.env` file (or export environment variables):

```bash .env
# Required
KEYWORDSAI_API_KEY=your-keywordsai-api-key

# Optional (defaults shown)
KEYWORDSAI_INGEST_BASE_URL=https://api.keywordsai.co/api
KEYWORDSAI_GATEWAY_BASE_URL=https://api.keywordsai.co

# Optional (only needed for "Call OpenAI directly" below)
OPENAI_API_KEY=your-openai-api-key
```

### Step 4: Run the gateway quickstart

Create `quickstart-gateway.js`:

```javascript
import "dotenv/config";

import { context, trace } from "@opentelemetry/api";
import { AsyncLocalStorageContextManager } from "@opentelemetry/context-async-hooks";
import { BasicTracerProvider, SimpleSpanProcessor } from "@opentelemetry/sdk-trace-base";

import { generateText } from "ai";
import { createOpenAI } from "@ai-sdk/openai";
import { KeywordsAIExporter } from "@keywordsai/exporter-aisdk";

async function main() {
  const apiKey = process.env.KEYWORDSAI_API_KEY;
  if (!apiKey) throw new Error("Missing KEYWORDSAI_API_KEY");

  // Ensure async context propagation works across awaits
  context.setGlobalContextManager(new AsyncLocalStorageContextManager().enable());

  // Export AI-SDK spans to Keywords AI
  const exporter = new KeywordsAIExporter({
    apiKey,
    baseUrl: process.env.KEYWORDSAI_INGEST_BASE_URL || "https://api.keywordsai.co/api",
    debug: true,
  });

  const provider = new BasicTracerProvider({
    spanProcessors: [new SimpleSpanProcessor(exporter)],
  });
  trace.setGlobalTracerProvider(provider);

  // Route the model call through the Keywords AI Gateway (uses KEYWORDSAI_API_KEY)
  const gatewayBase = (process.env.KEYWORDSAI_GATEWAY_BASE_URL || "https://api.keywordsai.co").replace(
    /\/$/,
    "",
  );
  const gatewayBaseURL = gatewayBase.endsWith("/api") ? `${gatewayBase}/` : `${gatewayBase}/api/`;

  const keywordsaiOpenAI = createOpenAI({
    apiKey,
    baseURL: gatewayBaseURL,
  });

  const result = await generateText({
    model: keywordsaiOpenAI("gpt-4o-mini"),
    prompt: "Hello from AI-SDK via KeywordsAI gateway!",
    experimental_telemetry: {
      isEnabled: true,
      metadata: {
        userId: "quickstart-user",
        integration: "@keywordsai/exporter-aisdk",
      },
    },
  });

  console.log(result.text);

  await provider.forceFlush();
  await provider.shutdown();
}

main().catch((err) => {
  console.error(err);
  process.exit(1);
});
```

Run it:

```bash
node quickstart-gateway.js
```

### Step 5: View traces in Keywords AI

Go to your [Keywords AI dashboard](https://platform.keywordsai.co/platform/dashboard) and open **Observability → Traces**.

<Frame className="rounded-md">
<img src="https://keywordsai-static.s3.us-east-1.amazonaws.com/docs/Integrations/AI-SDK/AI-SDK+quickstart+example+gateway.png" alt="AI-SDK quickstart traces in Keywords AI (gateway example)" />
</Frame>

## Optional: Call OpenAI directly (without the Keywords AI Gateway)

You can still export AI-SDK traces to Keywords AI while calling OpenAI directly with your original OpenAI key.

Replace the model provider in Step 4 with:

```javascript
import { createOpenAI } from "@ai-sdk/openai";

const openai = createOpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

const result = await generateText({
  model: openai("gpt-4o-mini"),
  prompt: "Hello from AI-SDK using OpenAI directly!",
  experimental_telemetry: { isEnabled: true },
});
```

## Next.js / App Router setup (recommended)

If you’re using Next.js, you can register the exporter via `@vercel/otel` in `instrumentation.ts`:

```typescript
import { registerOTel } from "@vercel/otel";
import { KeywordsAIExporter } from "@keywordsai/exporter-aisdk";

export function register() {
  registerOTel({
    serviceName: "my-ai-app",
    traceExporter: new KeywordsAIExporter({
      apiKey: process.env.KEYWORDSAI_API_KEY,
      baseUrl: "https://api.keywordsai.co/api",
      debug: true,
    }),
  });
}
```

Then enable AI SDK telemetry per call:

```typescript
import { generateText } from "ai";
import { openai } from "@ai-sdk/openai";

const result = await generateText({
  model: openai("gpt-4o-mini"),
  prompt: "Hello from AI-SDK!",
  experimental_telemetry: { isEnabled: true },
});
```

